clear all;
clc;
close;

cd 'E:\ARTIGOS\Denoising 60Hz ECG';
addpath('E:\ARTIGOS\Denoising 60Hz ECG\synthetic signals');
addpath('E:\PESQUISAS\Matlab');

format long;

wavelet = 'sym8';
level_dec = 3;
shrinkage_rule = 'h'; % s, h
thr_selection_rule = 'sqtwolog'; % rigrsure, sqtwolog, heursure, minimaxi
Fs = 500;

load('ecg1_n.mat');
load('ecg1.mat');
tic;
ecg_den1 = wden(ecg1_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time1 = toc;
error1 = E(ecg1, ecg_den1);
RMSE1 = RMSE(ecg1, ecg_den1);
r1 = corrcoef(ecg1, ecg_den1);
r1 = r1(2:2);
SNRimp1 = SNRimp(ecg1, ecg_den1, ecg1_n);
energySQI1 = eSQI(ecg1, Fs);
energySQI1_n = eSQI(ecg1_n, Fs);
energySQI1_den = eSQI(ecg_den1, Fs);

load('ecg2_n.mat');
load('ecg2.mat');
tic;
ecg_den2 = wden(ecg2_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time2 = toc;
error2 = E(ecg2, ecg_den2);
RMSE2 = RMSE(ecg2, ecg_den2);
r2 = corrcoef(ecg2, ecg_den2);
r2 = r2(2:2);
SNRimp2 = SNRimp(ecg2, ecg_den2, ecg2_n);
energySQI2 = eSQI(ecg2, Fs);
energySQI2_n = eSQI(ecg2_n, Fs);
energySQI2_den = eSQI(ecg_den2, Fs);

load('ecg3_n.mat');
load('ecg3.mat');
tic;
ecg_den3 = wden(ecg3_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time3 = toc;
error3 = E(ecg3, ecg_den3);
RMSE3 = RMSE(ecg3, ecg_den3);
r3 = corrcoef(ecg3, ecg_den3);
r3 = r3(2:2);
SNRimp3 = SNRimp(ecg3, ecg_den3, ecg3_n);
energySQI3 = eSQI(ecg3, Fs);
energySQI3_n = eSQI(ecg3_n, Fs);
energySQI3_den = eSQI(ecg_den3, Fs);

load('ecg4_n.mat');
load('ecg4.mat');
tic;
ecg_den4 = wden(ecg4_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time4 = toc;
error4 = E(ecg4, ecg_den4);
RMSE4 = RMSE(ecg4, ecg_den4);
r4 = corrcoef(ecg4, ecg_den4);
r4 = r4(2:2);
SNRimp4 = SNRimp(ecg4, ecg_den4, ecg4_n);
energySQI4 = eSQI(ecg4, Fs);
energySQI4_n = eSQI(ecg4_n, Fs);
energySQI4_den = eSQI(ecg_den4, Fs);

load('ecg5_n.mat');
load('ecg5.mat');
tic;
ecg_den5 = wden(ecg5_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time5 = toc;
error5 = E(ecg5, ecg_den5);
RMSE5 = RMSE(ecg5, ecg_den5);
r5 = corrcoef(ecg5, ecg_den5);
r5 = r5(2:2);
SNRimp5 = SNRimp(ecg5, ecg_den5, ecg5_n);
energySQI5 = eSQI(ecg5, Fs);
energySQI5_n = eSQI(ecg5_n, Fs);
energySQI5_den = eSQI(ecg_den5, Fs);

load('ecg6_n.mat');
load('ecg6.mat');
tic;
ecg_den6 = wden(ecg6_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time6 = toc;
error6 = E(ecg6, ecg_den6);
RMSE6 = RMSE(ecg6, ecg_den6);
r6 = corrcoef(ecg6, ecg_den6);
r6 = r6(2:2);
SNRimp6 = SNRimp(ecg6, ecg_den6, ecg6_n);
energySQI6 = eSQI(ecg6, Fs);
energySQI6_n = eSQI(ecg6_n, Fs);
energySQI6_den = eSQI(ecg_den6, Fs);

load('ecg7_n.mat');
load('ecg7.mat');
tic;
ecg_den7 = wden(ecg7_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time7 = toc;
error7 = E(ecg7, ecg_den7);
RMSE7 = RMSE(ecg7, ecg_den7);
r7 = corrcoef(ecg7, ecg_den7);
r7 = r7(2:2);
SNRimp7 = SNRimp(ecg7, ecg_den7, ecg7_n);
energySQI7 = eSQI(ecg7, Fs);
energySQI7_n = eSQI(ecg7_n, Fs);
energySQI7_den = eSQI(ecg_den7, Fs);

load('ecg8_n.mat');
load('ecg8.mat');
tic;
ecg_den8 = wden(ecg8_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time8 = toc;
error8 = E(ecg8, ecg_den8);
RMSE8 = RMSE(ecg8, ecg_den8);
r8 = corrcoef(ecg8, ecg_den8);
r8 = r8(2:2);
SNRimp8 = SNRimp(ecg8, ecg_den8, ecg8_n);
energySQI8 = eSQI(ecg8, Fs);
energySQI8_n = eSQI(ecg8_n, Fs);
energySQI8_den = eSQI(ecg_den8, Fs);

load('ecg9_n.mat');
load('ecg9.mat');
tic;
ecg_den9 = wden(ecg9_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time9 = toc;
error9 = E(ecg9, ecg_den9);
RMSE9 = RMSE(ecg9, ecg_den9);
r9 = corrcoef(ecg9, ecg_den9);
r9 = r9(2:2);
SNRimp9 = SNRimp(ecg9, ecg_den9, ecg9_n);
energySQI9 = eSQI(ecg9, Fs);
energySQI9_n = eSQI(ecg9_n, Fs);
energySQI9_den = eSQI(ecg_den9, Fs);

load('ecg10_n.mat');
load('ecg10.mat');
tic;
ecg_den10 = wden(ecg10_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time10 = toc;
error10 = E(ecg10, ecg_den10);
RMSE10 = RMSE(ecg10, ecg_den10);
r10 = corrcoef(ecg10, ecg_den10);
r10 = r10(2:2);
SNRimp10 = SNRimp(ecg10, ecg_den10, ecg10_n);
energySQI10 = eSQI(ecg10, Fs);
energySQI10_n = eSQI(ecg10_n, Fs);
energySQI10_den = eSQI(ecg_den10, Fs);

load('ecg11_n.mat');
load('ecg11.mat');
tic;
ecg_den11 = wden(ecg11_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time11 = toc;
error11 = E(ecg11, ecg_den11);
RMSE11 = RMSE(ecg11, ecg_den11);
r11 = corrcoef(ecg11, ecg_den11);
r11 = r11(2:2);
SNRimp11 = SNRimp(ecg11, ecg_den11, ecg11_n);
energySQI11 = eSQI(ecg11, Fs);
energySQI11_n = eSQI(ecg11_n, Fs);
energySQI11_den = eSQI(ecg_den11, Fs);

load('ecg12_n.mat');
load('ecg12.mat');
tic;
ecg_den12 = wden(ecg12_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time12 = toc;
error12 = E(ecg12, ecg_den12);
RMSE12 = RMSE(ecg12, ecg_den12);
r12 = corrcoef(ecg12, ecg_den12);
r12 = r12(2:2);
SNRimp12 = SNRimp(ecg12, ecg_den12, ecg12_n);
energySQI12 = eSQI(ecg12, Fs);
energySQI12_n = eSQI(ecg12_n, Fs);
energySQI12_den = eSQI(ecg_den12, Fs);

load('ecg13_n.mat');
load('ecg13.mat');
tic;
ecg_den13 = wden(ecg13_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time13 = toc;
error13 = E(ecg13, ecg_den13);
RMSE13 = RMSE(ecg13, ecg_den13);
r13 = corrcoef(ecg13, ecg_den13);
r13 = r13(2:2);
SNRimp13 = SNRimp(ecg13, ecg_den13, ecg13_n);
energySQI13 = eSQI(ecg13, Fs);
energySQI13_n = eSQI(ecg13_n, Fs);
energySQI13_den = eSQI(ecg_den13, Fs);

load('ecg14_n.mat');
load('ecg14.mat');
tic;
ecg_den14 = wden(ecg14_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time14 = toc;
error14 = E(ecg14, ecg_den14);
RMSE14 = RMSE(ecg14, ecg_den14);
r14 = corrcoef(ecg14, ecg_den14);
r14 = r14(2:2);
SNRimp14 = SNRimp(ecg14, ecg_den14, ecg14_n);
energySQI14 = eSQI(ecg14, Fs);
energySQI14_n = eSQI(ecg14_n, Fs);
energySQI14_den = eSQI(ecg_den14, Fs);

load('ecg15_n.mat');
load('ecg15.mat');
tic;
ecg_den15 = wden(ecg15_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time15 = toc;
error15 = E(ecg15, ecg_den15);
RMSE15 = RMSE(ecg15, ecg_den15);
r15 = corrcoef(ecg15, ecg_den15);
r15 = r15(2:2);
SNRimp15 = SNRimp(ecg15, ecg_den15, ecg15_n);
energySQI15 = eSQI(ecg15, Fs);
energySQI15_n = eSQI(ecg15_n, Fs);
energySQI15_den = eSQI(ecg_den15, Fs);

load('ecg16_n.mat');
load('ecg16.mat');
tic;
ecg_den16 = wden(ecg16_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time16 = toc;
error16 = E(ecg16, ecg_den16);
RMSE16 = RMSE(ecg16, ecg_den16);
r16 = corrcoef(ecg16, ecg_den16);
r16 = r16(2:2);
SNRimp16 = SNRimp(ecg16, ecg_den16, ecg16_n);
energySQI16 = eSQI(ecg16, Fs);
energySQI16_n = eSQI(ecg16_n, Fs);
energySQI16_den = eSQI(ecg_den16, Fs);

load('ecg17_n.mat');
load('ecg17.mat');
tic;
ecg_den17 = wden(ecg17_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time17 = toc;
error17 = E(ecg17, ecg_den17);
RMSE17 = RMSE(ecg17, ecg_den17);
r17 = corrcoef(ecg17, ecg_den17);
r17 = r17(2:2);
SNRimp17 = SNRimp(ecg17, ecg_den17, ecg17_n);
energySQI17 = eSQI(ecg17, Fs);
energySQI17_n = eSQI(ecg17_n, Fs);
energySQI17_den = eSQI(ecg_den17, Fs);

load('ecg18_n.mat');
load('ecg18.mat');
tic;
ecg_den18 = wden(ecg18_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time18 = toc;
error18 = E(ecg18, ecg_den18);
RMSE18 = RMSE(ecg18, ecg_den18);
r18 = corrcoef(ecg18, ecg_den18);
r18 = r18(2:2);
SNRimp18 = SNRimp(ecg18, ecg_den18, ecg18_n);
energySQI18 = eSQI(ecg18, Fs);
energySQI18_n = eSQI(ecg18_n, Fs);
energySQI18_den = eSQI(ecg_den18, Fs);

load('ecg19_n.mat');
load('ecg19.mat');
tic;
ecg_den19 = wden(ecg19_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time19 = toc;
error19 = E(ecg19, ecg_den19);
RMSE19 = RMSE(ecg19, ecg_den19);
r19 = corrcoef(ecg19, ecg_den19);
r19 = r19(2:2);
SNRimp19 = SNRimp(ecg19, ecg_den19, ecg19_n);
energySQI19 = eSQI(ecg19, Fs);
energySQI19_n = eSQI(ecg19_n, Fs);
energySQI19_den = eSQI(ecg_den19, Fs);

load('ecg20_n.mat');
load('ecg20.mat');
tic;
ecg_den20 = wden(ecg20_n, thr_selection_rule, shrinkage_rule, 'mln', level_dec, wavelet);
time20 = toc;
error20 = E(ecg20, ecg_den20);
RMSE20 = RMSE(ecg20, ecg_den20);
r20 = corrcoef(ecg20, ecg_den20);
r20 = r20(2:2);
SNRimp20 = SNRimp(ecg20, ecg_den20, ecg20_n);
energySQI20 = eSQI(ecg20, Fs);
energySQI20_n = eSQI(ecg20_n, Fs);
energySQI20_den = eSQI(ecg_den20, Fs);

