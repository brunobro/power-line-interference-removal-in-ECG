clear all;
clc;
close;

cd 'E:\ARTIGOS\Denoising 60Hz ECG\scripts\';
addpath('E:\ARTIGOS\Denoising 60Hz ECG\scripts\synthetic signals');
addpath('E:\PESQUISAS\Matlab');

format long;

%medidas
times   = [];
errors  = [];
RMSEs   = [];
rs      = [];
SNRimps = [];

wavelet = 'sym12';
window_len = 1000;
Fs = 500;

load('ecg1_n.mat');
load('ecg1.mat');
tic;
ecg_den1 = MyDenoising(ecg1_n, wavelet, 3, window_len);
time1 = toc;
error1 = E(ecg1, ecg_den1);
RMSE1 = RMSE(ecg1, ecg_den1);
r1 = corrcoef(ecg1, ecg_den1);
r1 = r1(2:2);
SNRimp1 = SNRimp(ecg1, ecg_den1, ecg1_n);
energySQI1 = eSQI(ecg1, Fs);
energySQI1_n = eSQI(ecg1_n, Fs);
energySQI1_den = eSQI(ecg_den1, Fs);
times = [times time1];
RMSEs = [RMSEs RMSE1];
errors = [errors error1];
rs = [rs r1];
SNRimps = [SNRimps SNRimp1];

load('ecg2_n.mat');
load('ecg2.mat');
tic;
ecg_den2 = MyDenoising(ecg2_n, wavelet, 3, window_len);
time2 = toc;
error2 = E(ecg2, ecg_den2);
RMSE2 = RMSE(ecg2, ecg_den2);
r2 = corrcoef(ecg2, ecg_den2);
r2 = r2(2:2);
SNRimp2 = SNRimp(ecg2, ecg_den2, ecg2_n);
energySQI2 = eSQI(ecg2, Fs);
energySQI2_n = eSQI(ecg2_n, Fs);
energySQI2_den = eSQI(ecg_den2, Fs);
times = [times time2];
RMSEs = [RMSEs RMSE2];
errors = [errors error2];
rs = [rs r2];
SNRimps = [SNRimps SNRimp2];

load('ecg3_n.mat');
load('ecg3.mat');
tic;
ecg_den3 = MyDenoising(ecg3_n, wavelet, 3, window_len);
time3 = toc;
error3 = E(ecg3, ecg_den3);
RMSE3 = RMSE(ecg3, ecg_den3);
r3 = corrcoef(ecg3, ecg_den3);
r3 = r3(2:2);
SNRimp3 = SNRimp(ecg3, ecg_den3, ecg3_n);
energySQI3 = eSQI(ecg3, Fs);
energySQI3_n = eSQI(ecg3_n, Fs);
energySQI3_den = eSQI(ecg_den3, Fs);
times = [times time3];
RMSEs = [RMSEs RMSE3];
errors = [errors error3];
rs = [rs r3];
SNRimps = [SNRimps SNRimp3];

load('ecg4_n.mat');
load('ecg4.mat');
tic;
ecg_den4 = MyDenoising(ecg4_n, wavelet, 3, window_len);
time4 = toc;
error4 = E(ecg4, ecg_den4);
RMSE4 = RMSE(ecg4, ecg_den4);
r4 = corrcoef(ecg4, ecg_den4);
r4 = r4(2:2);
SNRimp4 = SNRimp(ecg4, ecg_den4, ecg4_n);
energySQI4 = eSQI(ecg4, Fs);
energySQI4_n = eSQI(ecg4_n, Fs);
energySQI4_den = eSQI(ecg_den4, Fs);
times = [times time4];
RMSEs = [RMSEs RMSE4];
errors = [errors error4];
rs = [rs r4];
SNRimps = [SNRimps SNRimp4];

load('ecg5_n.mat');
load('ecg5.mat');
tic;
ecg_den5 = MyDenoising(ecg5_n, wavelet, 3, window_len);
time5 = toc;
error5 = E(ecg5, ecg_den5);
RMSE5 = RMSE(ecg5, ecg_den5);
r5 = corrcoef(ecg5, ecg_den5);
r5 = r5(2:2);
SNRimp5 = SNRimp(ecg5, ecg_den5, ecg5_n);
energySQI5 = eSQI(ecg5, Fs);
energySQI5_n = eSQI(ecg5_n, Fs);
energySQI5_den = eSQI(ecg_den5, Fs);
times = [times time5];
RMSEs = [RMSEs RMSE5];
errors = [errors error5];
rs = [rs r5];
SNRimps = [SNRimps SNRimp5];

load('ecg6_n.mat');
load('ecg6.mat');
tic;
ecg_den6 = MyDenoising(ecg6_n, wavelet, 3, window_len);
time6 = toc;
error6 = E(ecg6, ecg_den6);
RMSE6 = RMSE(ecg6, ecg_den6);
r6 = corrcoef(ecg6, ecg_den6);
r6 = r6(2:2);
SNRimp6 = SNRimp(ecg6, ecg_den6, ecg6_n);
energySQI6 = eSQI(ecg6, Fs);
energySQI6_n = eSQI(ecg6_n, Fs);
energySQI6_den = eSQI(ecg_den6, Fs);
times = [times time6];
RMSEs = [RMSEs RMSE6];
errors = [errors error6];
rs = [rs r6];
SNRimps = [SNRimps SNRimp6];

load('ecg7_n.mat');
load('ecg7.mat');
tic;
ecg_den7 = MyDenoising(ecg7_n, wavelet, 3, window_len);
time7 = toc;
error7 = E(ecg7, ecg_den7);
RMSE7 = RMSE(ecg7, ecg_den7);
r7 = corrcoef(ecg7, ecg_den7);
r7 = r7(2:2);
SNRimp7 = SNRimp(ecg7, ecg_den7, ecg7_n);
energySQI7 = eSQI(ecg7, Fs);
energySQI7_n = eSQI(ecg7_n, Fs);
energySQI7_den = eSQI(ecg_den7, Fs);
times = [times time7];
RMSEs = [RMSEs RMSE7];
errors = [errors error7];
rs = [rs r7];
SNRimps = [SNRimps SNRimp7];

load('ecg8_n.mat');
load('ecg8.mat');
tic;
ecg_den8 = MyDenoising(ecg8_n, wavelet, 3, window_len);
time8 = toc;
error8 = E(ecg8, ecg_den8);
RMSE8 = RMSE(ecg8, ecg_den8);
r8 = corrcoef(ecg8, ecg_den8);
r8 = r8(2:2);
SNRimp8 = SNRimp(ecg8, ecg_den8, ecg8_n);
energySQI8 = eSQI(ecg8, Fs);
energySQI8_n = eSQI(ecg8_n, Fs);
energySQI8_den = eSQI(ecg_den8, Fs);
times = [times time8];
RMSEs = [RMSEs RMSE8];
errors = [errors error8];
rs = [rs r1];
SNRimps = [SNRimps SNRimp8];

load('ecg9_n.mat');
load('ecg9.mat');
tic;
ecg_den9 = MyDenoising(ecg9_n, wavelet, 3, window_len);
time9 = toc;
error9 = E(ecg9, ecg_den9);
RMSE9 = RMSE(ecg9, ecg_den9);
r9 = corrcoef(ecg9, ecg_den9);
r9 = r9(2:2);
SNRimp9 = SNRimp(ecg9, ecg_den9, ecg9_n);
energySQI9 = eSQI(ecg9, Fs);
energySQI9_n = eSQI(ecg9_n, Fs);
energySQI9_den = eSQI(ecg_den9, Fs);
times = [times time9];
RMSEs = [RMSEs RMSE9];
errors = [errors error9];
rs = [rs r9];
SNRimps = [SNRimps SNRimp9];

load('ecg10_n.mat');
load('ecg10.mat');
tic;
ecg_den10 = MyDenoising(ecg10_n, wavelet, 3, window_len);
time10 = toc;
error10 = E(ecg10, ecg_den10);
RMSE10 = RMSE(ecg10, ecg_den10);
r10 = corrcoef(ecg10, ecg_den10);
r10 = r10(2:2);
SNRimp10 = SNRimp(ecg10, ecg_den10, ecg10_n);
energySQI10 = eSQI(ecg10, Fs);
energySQI10_n = eSQI(ecg10_n, Fs);
energySQI10_den = eSQI(ecg_den10, Fs);
times = [times time10];
RMSEs = [RMSEs RMSE10];
errors = [errors error10];
rs = [rs r10];
SNRimps = [SNRimps SNRimp10];

load('ecg11_n.mat');
load('ecg11.mat');
tic;
ecg_den11 = MyDenoising(ecg11_n, wavelet, 3, window_len);
time11 = toc;
error11 = E(ecg11, ecg_den11);
RMSE11 = RMSE(ecg11, ecg_den11);
r11 = corrcoef(ecg11, ecg_den11);
r11 = r11(2:2);
SNRimp11 = SNRimp(ecg11, ecg_den11, ecg11_n);
energySQI11 = eSQI(ecg11, Fs);
energySQI11_n = eSQI(ecg11_n, Fs);
energySQI11_den = eSQI(ecg_den11, Fs);
times = [times time11];
RMSEs = [RMSEs RMSE11];
errors = [errors error11];
rs = [rs r11];
SNRimps = [SNRimps SNRimp11];

load('ecg12_n.mat');
load('ecg12.mat');
tic;
ecg_den12 = MyDenoising(ecg12_n, wavelet, 3, window_len);
time12 = toc;
error12 = E(ecg12, ecg_den12);
RMSE12 = RMSE(ecg12, ecg_den12);
r12 = corrcoef(ecg12, ecg_den12);
r12 = r12(2:2);
SNRimp12 = SNRimp(ecg12, ecg_den12, ecg12_n);
energySQI12 = eSQI(ecg12, Fs);
energySQI12_n = eSQI(ecg12_n, Fs);
energySQI12_den = eSQI(ecg_den12, Fs);
times = [times time12];
RMSEs = [RMSEs RMSE12];
errors = [errors error12];
rs = [rs r12];
SNRimps = [SNRimps SNRimp12];

load('ecg13_n.mat');
load('ecg13.mat');
tic;
ecg_den13 = MyDenoising(ecg13_n, wavelet, 3, window_len);
time13 = toc;
error13 = E(ecg13, ecg_den13);
RMSE13 = RMSE(ecg13, ecg_den13);
r13 = corrcoef(ecg13, ecg_den13);
r13 = r13(2:2);
SNRimp13 = SNRimp(ecg13, ecg_den13, ecg13_n);
energySQI13 = eSQI(ecg13, Fs);
energySQI13_n = eSQI(ecg13_n, Fs);
energySQI13_den = eSQI(ecg_den13, Fs);
times = [times time13];
RMSEs = [RMSEs RMSE13];
errors = [errors error13];
rs = [rs r13];
SNRimps = [SNRimps SNRimp13];

load('ecg14_n.mat');
load('ecg14.mat');
tic;
ecg_den14 = MyDenoising(ecg14_n, wavelet, 3, window_len);
time14 = toc;
error14 = E(ecg14, ecg_den14);
RMSE14 = RMSE(ecg14, ecg_den14);
r14 = corrcoef(ecg14, ecg_den14);
r14 = r14(2:2);
SNRimp14 = SNRimp(ecg14, ecg_den14, ecg14_n);
energySQI14 = eSQI(ecg14, Fs);
energySQI14_n = eSQI(ecg14_n, Fs);
energySQI14_den = eSQI(ecg_den14, Fs);
times = [times time14];
RMSEs = [RMSEs RMSE14];
errors = [errors error14];
rs = [rs r14];
SNRimps = [SNRimps SNRimp14];

load('ecg15_n.mat');
load('ecg15.mat');
tic;
ecg_den15 = MyDenoising(ecg15_n, wavelet, 3, window_len);
time15 = toc;
error15 = E(ecg15, ecg_den15);
RMSE15 = RMSE(ecg15, ecg_den15);
r15 = corrcoef(ecg15, ecg_den15);
r15 = r15(2:2);
SNRimp15 = SNRimp(ecg15, ecg_den15, ecg15_n);
energySQI15 = eSQI(ecg15, Fs);
energySQI15_n = eSQI(ecg15_n, Fs);
energySQI15_den = eSQI(ecg_den15, Fs);
times = [times time15];
RMSEs = [RMSEs RMSE15];
errors = [errors error15];
rs = [rs r15];
SNRimps = [SNRimps SNRimp15];

load('ecg16_n.mat');
load('ecg16.mat');
tic;
ecg_den16 = MyDenoising(ecg16_n, wavelet, 3, window_len);
time16 = toc;
error16 = E(ecg16, ecg_den16);
RMSE16 = RMSE(ecg16, ecg_den16);
r16 = corrcoef(ecg16, ecg_den16);
r16 = r16(2:2);
SNRimp16 = SNRimp(ecg16, ecg_den16, ecg16_n);
energySQI16 = eSQI(ecg16, Fs);
energySQI16_n = eSQI(ecg16_n, Fs);
energySQI16_den = eSQI(ecg_den16, Fs);
times = [times time16];
RMSEs = [RMSEs RMSE16];
errors = [errors error16];
rs = [rs r16];
SNRimps = [SNRimps SNRimp16];

load('ecg17_n.mat');
load('ecg17.mat');
tic;
ecg_den17 = MyDenoising(ecg17_n, wavelet, 3, window_len);
time17 = toc;
error17 = E(ecg17, ecg_den17);
RMSE17 = RMSE(ecg17, ecg_den17);
r17 = corrcoef(ecg17, ecg_den17);
r17 = r17(2:2);
SNRimp17 = SNRimp(ecg17, ecg_den17, ecg17_n);
energySQI17 = eSQI(ecg17, Fs);
energySQI17_n = eSQI(ecg17_n, Fs);
energySQI17_den = eSQI(ecg_den17, Fs);
times = [times time17];
RMSEs = [RMSEs RMSE17];
errors = [errors error17];
rs = [rs r17];
SNRimps = [SNRimps SNRimp17];

load('ecg18_n.mat');
load('ecg18.mat');
tic;
ecg_den18 = MyDenoising(ecg18_n, wavelet, 3, window_len);
time18 = toc;
error18 = E(ecg18, ecg_den18);
RMSE18 = RMSE(ecg18, ecg_den18);
r18 = corrcoef(ecg18, ecg_den18);
r18 = r18(2:2);
SNRimp18 = SNRimp(ecg18, ecg_den18, ecg18_n);
energySQI18 = eSQI(ecg18, Fs);
energySQI18_n = eSQI(ecg18_n, Fs);
energySQI18_den = eSQI(ecg_den18, Fs);
times = [times time18];
RMSEs = [RMSEs RMSE18];
errors = [errors error18];
rs = [rs r18];
SNRimps = [SNRimps SNRimp18];

load('ecg19_n.mat');
load('ecg19.mat');
tic;
ecg_den19 = MyDenoising(ecg19_n, wavelet, 3, window_len);
time19 = toc;
error19 = E(ecg19, ecg_den19);
RMSE19 = RMSE(ecg19, ecg_den19);
r19 = corrcoef(ecg19, ecg_den19);
r19 = r19(2:2);
SNRimp19 = SNRimp(ecg19, ecg_den19, ecg19_n);
energySQI19 = eSQI(ecg19, Fs);
energySQI19_n = eSQI(ecg19_n, Fs);
energySQI19_den = eSQI(ecg_den19, Fs);
times = [times time19];
RMSEs = [RMSEs RMSE19];
errors = [errors error19];
rs = [rs r19];
SNRimps = [SNRimps SNRimp19];

load('ecg20_n.mat');
load('ecg20.mat');
tic;
ecg_den20 = MyDenoising(ecg20_n, wavelet, 3, window_len);
time20 = toc;
error20 = E(ecg20, ecg_den20);
RMSE20 = RMSE(ecg20, ecg_den20);
r20 = corrcoef(ecg20, ecg_den20);
r20 = r20(2:2);
SNRimp20 = SNRimp(ecg20, ecg_den20, ecg20_n);
energySQI20 = eSQI(ecg20, Fs);
energySQI20_n = eSQI(ecg20_n, Fs);
energySQI20_den = eSQI(ecg_den20, Fs);
times = [times time20];
RMSEs = [RMSEs RMSE20];
errors = [errors error20];
rs = [rs r20];
SNRimps = [SNRimps SNRimp20];

% fig = figure;
% t = 1:1500;
% subplot(521);plot(t, ecg1(1:1500), t, ecg_den1(1:1500));title('s_1 (t)');axis off;
% subplot(522);plot(t, ecg2(1:1500), t, ecg_den2(1:1500));title('s_2 (t)');axis off;
% subplot(523);plot(t, ecg3(1:1500), t, ecg_den3(1:1500));title('s_3 (t)');axis off;
% subplot(524);plot(t, ecg4(1:1500), t, ecg_den4(1:1500));title('s_4 (t)');axis off;
% subplot(525);plot(t, ecg5(1:1500), t, ecg_den5(1:1500));title('s_5 (t)');axis off;
% subplot(526);plot(t, ecg6(1:1500), t, ecg_den6(1:1500));title('s_6 (t)');axis off;
% subplot(527);plot(t, ecg7(1:1500), t, ecg_den7(1:1500));title('s_7 (t)');axis off;
% subplot(528);plot(t, ecg8(1:1500), t, ecg_den8(1:1500));title('s_8 (t)');axis off;
% subplot(529);plot(t, ecg9(1:1500), t, ecg_den9(1:1500));title('s_9 (t)');axis off;
% subplot(5,2,10);plot(t, ecg10(1:1500), t, ecg_den10(1:1500));title('s_{10} (t)');axis off;
% legend({'Original ECG','Denoised ECG'},'Position',[0.45,0.03,0.1,0.1]);

